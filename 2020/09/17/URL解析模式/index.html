<!DOCTYPE html>


<html lang="en">


<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    ThinkPhP学习第一天 |  
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

  
  

  

<link rel="alternate" href="/atom.xml" title="Anti-Genemits" type="application/atom+xml">
</head>

</html>

<body>
  <div id="app">
    
      <canvas class="fireworks"></canvas>
      <style>
        .fireworks {
          position: fixed;
          left: 0;
          top: 0;
          z-index: 99999;
          pointer-events: none;
        }
      </style>
      
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-URL解析模式"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  ThinkPhP学习第一天
</h1>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/09/17/URL%E8%A7%A3%E6%9E%90%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time datetime="2020-09-17T11:50:05.000Z" itemprop="datePublished">2020-09-17</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> Word count:</span>
            <span class="post-count">2.8k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> Reading time≈</span>
            <span class="post-count">13 min</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="ThinkPhP学习-第一天"><a href="#ThinkPhP学习-第一天" class="headerlink" title="ThinkPhP学习-第一天"></a>ThinkPhP学习-第一天</h1><h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><p>.htaceess</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;IfModule mod_rewrite.c&gt;</span><br><span class="line">  Options +FollowSymlinks -Multiviews</span><br><span class="line">  RewriteEngine On</span><br><span class="line"></span><br><span class="line">  RewriteCond %&#123;REQUEST_FILENAME&#125; !-d</span><br><span class="line">  RewriteCond %&#123;REQUEST_FILENAME&#125; !-f</span><br><span class="line">  RewriteRule ^(.*)$ index.php [L,E=PATH_INFO:$<span class="number">1</span>]</span><br><span class="line">&lt;/IfModule&gt;</span><br></pre></td></tr></table></figure>

<p>要改成这样，并且打开伪静态模块</p>
<a id="more"></a>

<h2 id="学习开始"><a href="#学习开始" class="headerlink" title="学习开始"></a>学习开始</h2><h2 id="URL解析模式"><a href="#URL解析模式" class="headerlink" title="URL解析模式"></a>URL解析模式</h2><p><code>http://serverName/index.php/模块/控制器/操作/参数/值…</code></p>
<p>首先这就是一个正常的URL模式的解析示例</p>
<p>index.php =&gt; 入口文件</p>
<p>模块 =&gt; application 目录下的一个可自定义的目录(默认index)</p>
<p>控制器=&gt;在 index 目录下有一个 controller 控制器目录的 Index.php 控制器(<strong>Index.php 控制器的类名也必须是 class Index)</strong></p>
<p>操作 =》 就是类的一个方法</p>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">test</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Abc</span> </span>&#123; <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">eat</span>(<span class="params">$who = <span class="string">&#x27;隔壁老王&#x27;</span></span>) </span>&#123; <span class="keyword">return</span> $who.<span class="string">&#x27;吃饭！&#x27;</span>; &#125; &#125;</span><br></pre></td></tr></table></figure>

<p>将以上代码复制到application目录下的test目录下的controller目录下的Abc.php（控制器）</p>
<p>则 url就是 ：<code>public/index.php/test/abc/eat/who/主人老李</code></p>
<h2 id="模块设计"><a href="#模块设计" class="headerlink" title="模块设计"></a>模块设计</h2><h3 id="一-目录架构"><a href="#一-目录架构" class="headerlink" title="一.目录架构"></a>一.目录架构</h3><p>1.thinkphp多模块，单模块均支持，通过<code>app_multi_module</code>这个参数来调节</p>
<p>2.手册上的目录架构</p>
<p><img src="https://i.loli.net/2020/09/17/78251DvgTrGRwdn.png"></p>
<p>3.命令空间统一：app\模块名  eg：：<code>app\index\controller\Index</code> </p>
<p>4.多模块访问必须指定模块，单模块则不用</p>
<p>5.绑定了模块，然后绑定了控制器</p>
<p><code>    Container::get(&#39;app&#39;)-&gt;bind(&#39;test/abc&#39;)-&gt;run()-&gt;send();</code></p>
<h3 id="二、空模块"><a href="#二、空模块" class="headerlink" title="二、空模块"></a>二、空模块</h3><p><code>&#39;empty_module&#39;</code></p>
<p> 可以通过环境变量设置空目录，将不存在的目录统一指向指定目录； </p>
<h3 id="三、单一模块"><a href="#三、单一模块" class="headerlink" title="三、单一模块"></a>三、单一模块</h3><p>命名空间改为<code>app/controller</code></p>
<p>目录架构改为:</p>
<p><img src="https://i.loli.net/2020/09/17/7TpNWY64n3eIMZE.png"></p>
<h3 id="四、环境变量"><a href="#四、环境变量" class="headerlink" title="四、环境变量"></a>四、环境变量</h3><p>ThinkPHP5.1 提供了一个类库 Env 来获取环境变量； <code>return Env::get(&#39;app_path&#39;);</code></p>
<p><img src="https://i.loli.net/2020/09/17/Nr3xbTnHoFpOfdk.png"></p>
<h2 id="控制器定义"><a href="#控制器定义" class="headerlink" title="控制器定义"></a>控制器定义</h2><h3 id="一．控制器定义"><a href="#一．控制器定义" class="headerlink" title="一．控制器定义"></a>一．控制器定义</h3><ol>
<li>控制器，即 controller，控制器文件存放在 controller 目录下；</li>
<li>类名和文件名大小写保持一致，并采用驼峰式（首字母大写）； use think\Controller; class Index extends Controller</li>
<li>继承控制器基类，可以更方便使用功能，但不是必须的；</li>
<li>系统也提供了其它方式，在不继承的情况下完成相同功能； </li>
<li>前面我们知道如果是一个单词，首字母大写，比如 class Index；</li>
<li>URL 访问时直接 public/index 即可； </li>
<li>那么如果创建的是双字母组合，比如 class HelloWorld； </li>
<li>URL 访问时必须为：public/hello_world； </li>
<li>如果你想原样的方式访问 URL，则需要关闭配置文件中自动转换； ‘url_convert’ =&gt; false,</li>
<li>此时，URL 访问可以为：public/HelloWorld； </li>
<li>如果你想改变根命名空间 app 为其它，可以在根目录下创建.env 文件； </li>
<li>后写上配对的键值对即可，app_namespace=application</li>
</ol>
<h3 id="二、渲染输出"><a href="#二、渲染输出" class="headerlink" title="二、渲染输出"></a>二、渲染输出</h3><p>ThinkPHP 直接采用方法内 return 返回的方式直接就输出了； </p>
<p> 使用 json 输出，直接采用 json 函数； </p>
<p><code>$data = array(&#39;a&#39;=&gt;1, &#39;b&#39;=&gt;2, &#39;c&#39;=&gt;3); return json($data);</code></p>
<p>使用 view 输出模版，开启错误提示，可知道如何创建模版； </p>
<p>return view();</p>
<p>默认输出方式为 html 格式输出，如果返回的是数组，则会报错；</p>
<p> 可以更改配置文件里的默认输出类型，更改为 json； return [‘user’=&gt;’Lee’, ‘age’=&gt;100]; ‘default_return_type’ =&gt; ‘json’,</p>
<p>一般来说，正常页面都是 html 输出，用于模版，AJAX 默认为 json； </p>
<p>如果继承了基类控制器，那么可以定义控制器初始化方法：initialize()； </p>
<p>initialize()方法会在调用控制器方法之前执行； protected function initialize() { //parent::initialize(); echo ‘init’; }</p>
<p>initialize()方法不需要任何返回值，输出用 PHP 方式，return 无效；</p>
<h2 id="控制器的编写"><a href="#控制器的编写" class="headerlink" title="控制器的编写"></a>控制器的编写</h2><h3 id="一、前置操作"><a href="#一、前置操作" class="headerlink" title="一、前置操作"></a>一、前置操作</h3><ol>
<li><p>继承 Controller 类后可以设置一个$beforeActionList 属性来创建前置方法；</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> $beforeActionList=[</span><br><span class="line">        <span class="string">&#x27;first&#x27;</span>,</span><br><span class="line">        <span class="comment">//one 方法不执行</span></span><br><span class="line">        <span class="string">&#x27;second&#x27;</span> =&gt; [<span class="string">&#x27;except&#x27;</span>=&gt;<span class="string">&#x27;one&#x27;</span>],</span><br><span class="line">        <span class="comment">//指定调用</span></span><br><span class="line">        <span class="string">&#x27;third&#x27;</span> =&gt; [<span class="string">&#x27;only&#x27;</span>=&gt;<span class="string">&#x27;one&#x27;</span>],</span><br><span class="line">    ];</span><br></pre></td></tr></table></figure>

<p><strong>要继承</strong></p>
</li>
<li><p>此时，我们可以分别 URL 访问不同的方法来理解前置的触发执行；</p>
</li>
</ol>
<h3 id="二、跳转和重定向"><a href="#二、跳转和重定向" class="headerlink" title="二、跳转和重定向"></a>二、跳转和重定向</h3><p>1.Controller 提供两个跳转方法 success(msg,url) 和error(msg);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if($this-&gt;flag)</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;不指定，就返回refer</span><br><span class="line">            $this-&gt;success(&#39;注册成功&#39;,&#39;..&#x2F;&#39;);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            $this-&gt;error(&quot;失败&quot;);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>2.成功或错误有一个固定的页面模版：’thinkphp/tpl/dispatch_jump.tpl’； </p>
<p>3.在 app.php 配置文件中，我们可以更改自己个性化的跳转页面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#39;dispatch_success_tmpl&#39; &#x3D;&gt; Env::get(&#39;think_path&#39;) </span><br><span class="line">&#39;tpl&#x2F;dispatch_jump.tpl&#39;, &#39;dispatch_error_tmpl&#39; &#x3D;&gt; Env::get(&#39;think_path&#39;) . &#39;tpl&#x2F;dispatch_jump.tpl&#39;,</span><br></pre></td></tr></table></figure>

<p>4.环境变量</p>
<p><img src="https://i.loli.net/2020/09/17/7QtCDzHNShp3MfU.png"></p>
<h3 id="二、空方法和空控制器"><a href="#二、空方法和空控制器" class="headerlink" title="二、空方法和空控制器"></a>二、空方法和空控制器</h3><p>1.不存在的方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;空方法拦截</span><br><span class="line">    public function _empty($name)</span><br><span class="line">    &#123;</span><br><span class="line">        return $name;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>2.不存在控制器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class Error</span><br><span class="line">&#123;</span><br><span class="line">    public function index(Request $request)</span><br><span class="line">    &#123;</span><br><span class="line">        return &#39;此控制器不存在&#39;.$request-&gt;controller();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.默认空控制器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 默认的空控制器名</span><br><span class="line">    &#39;empty_controller&#39;       &#x3D;&gt; &#39;Error&#39;,</span><br></pre></td></tr></table></figure>

<h2 id="数据库与模型"><a href="#数据库与模型" class="headerlink" title="数据库与模型"></a>数据库与模型</h2><h3 id="一、连接数据库（PDO模式）"><a href="#一、连接数据库（PDO模式）" class="headerlink" title="一、连接数据库（PDO模式）"></a>一、连接数据库（PDO模式）</h3><p><code>config</code>下的<code>database.php</code>可以配置链接数据</p>
<p>具体配置属性到配置文件查看</p>
<p>###　二、开始使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public  function getNoModelData()</span><br><span class="line">    &#123;</span><br><span class="line">       &#x2F;&#x2F;$data &#x3D; Db::table(&#39;tp_user&#39;)-&gt;select();</span><br><span class="line">        $data &#x3D; Db::name(&#39;user&#39;)-&gt;select();</span><br><span class="line">        return json($data);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意区别</strong></p>
<h3 id="三、模型定义"><a href="#三、模型定义" class="headerlink" title="三、模型定义"></a>三、模型定义</h3><p>模型：处理数据库相关模型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">namespace app\model;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">use think\Model;</span><br><span class="line"></span><br><span class="line">class User extends Model</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>应用trace 查看原生的SQL；</p>
<h2 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Db::table(&#39;tp_user&#39;)-&gt;find();&#x2F;&#x2F;查询出一条数据</span><br><span class="line">Db::getLastSql();&#x2F;&#x2F;查询上一次使用的查询语句是什么</span><br><span class="line">$data &#x3D; Db::table(&#39;tp_user&#39;)-&gt;where(&#39;id&#39;,27)-&gt;find(); 指定查询，链式</span><br><span class="line">无返回值，就是null</span><br><span class="line"> $data &#x3D; Db::table(&#39;tp_user&#39;)-&gt;where(&#39;id&#39;,127)-&gt;findOrFail(); 查找不到就抛出异常</span><br><span class="line"> Db::table(&#39;tp_user&#39;)-&gt;where(&#39;id&#39;,127)-&gt;findOrEmpty(); 查询不到就返回空数组</span><br><span class="line"> $data &#x3D; Db::table(&#39;tp_user&#39;)-&gt;select(); 查询多列数据</span><br><span class="line"> $data &#x3D; Db::table(&#39;tp_user&#39;)-&gt;where(&#39;id&#39;,27)-&gt;selectOrFail();</span><br><span class="line"> Db::name()不需要前缀</span><br></pre></td></tr></table></figure>

<p>助手函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\db助手函数</span><br><span class="line">Db::name(&#39;user&#39;)-&gt;value(&#39;username&#39;);指定字段的值</span><br><span class="line">Db::name(&#39;user&#39;)-&gt;column(&#39;username&#39;,&#39;id&#39;);一列的值，并且用id作为索引，返回一个array</span><br></pre></td></tr></table></figure>

<p>数据分批处理和大数据处理和json数据处理，具体问题具体分析</p>
<h2 id="链式查询"><a href="#链式查询" class="headerlink" title="链式查询"></a>链式查询</h2><h3 id="一-查询规则"><a href="#一-查询规则" class="headerlink" title="一.查询规则"></a>一.查询规则</h3><p>1.<code>-&gt;</code>多次调用</p>
<p>2<code>.find(),select()</code>结束查询</p>
<p>3.有多少种链式查询规则呢？</p>
<h3 id="二、多次查询"><a href="#二、多次查询" class="headerlink" title="二、多次查询"></a>二、多次查询</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$user &#x3D; Db::name(&#39;user&#39;);</span><br><span class="line">        $data1 &#x3D; $user-&gt;where(&#39;id&#39;,27)-&gt;select();</span><br><span class="line">        $data2 &#x3D; $user-&gt;removeOption(&#39;where&#39;)-&gt;select();</span><br><span class="line">        return json($data2);</span><br></pre></td></tr></table></figure>

<h2 id="增删改操作"><a href="#增删改操作" class="headerlink" title="增删改操作"></a>增删改操作</h2><h3 id="一-新增数据"><a href="#一-新增数据" class="headerlink" title="一.新增数据"></a>一.新增数据</h3><p><code>insert()</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$data = [ &#x27;username&#x27; =&gt; &#x27;辉夜&#x27;, &#x27;password&#x27; =&gt; &#x27;123&#x27;, &#x27;gender&#x27; =&gt; &#x27;女&#x27;, &#x27;email&#x27; =&gt; &#x27;huiye@163.com&#x27;, &#x27;price&#x27; =&gt; 90, &#x27;details&#x27; =&gt; &#x27;123&#x27;, &#x27;create_time&#x27; =&gt; date(&#x27;Y-m-d H:i:s&#x27;) ]</span><br><span class="line">Db::name(&#x27;user&#x27;)-&gt;insert($data);</span><br><span class="line">Db::name(&#x27;user&#x27;)-&gt;data($data)-&gt;insert();</span><br></pre></td></tr></table></figure>

<p>会返回一个影响行数</p>
<p><strong>mysql支持replace写入</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::name(&#39;user&#39;)-&gt;insert($data,true);唯一确定标识的时候，就会把原来的参数删除掉，然后新建</span><br></pre></td></tr></table></figure>

<p>批量写入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::name(&#39;user&#39;)-&gt;insertAll($dataAll);二维数组，其余相同</span><br></pre></td></tr></table></figure>

<h3 id="二-修改数据"><a href="#二-修改数据" class="headerlink" title="二.修改数据"></a>二.修改数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$data &#x3D; [</span><br><span class="line">            &#39;username&#39; &#x3D;&gt; &#39;李白&#39;,</span><br><span class="line">        ];</span><br><span class="line">Db::name(&#39;user&#39;)-&gt;where(&#39;id&#39;,239)-&gt;update($data);</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::name(&#39;user&#39;)-&gt;where(&#39;id&#39;, 38)-&gt; data($data)-&gt;update([&#39;password&#39;&#x3D;&gt;&#39;456&#39;]);</span><br></pre></td></tr></table></figure>

<p>如果有唯一性主键</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data &#x3D; [ &#39;username&#39; &#x3D;&gt; &#39;李白&#39;, &#39;id&#39; &#x3D;&gt; 38 ]; Db::name(&#39;user&#39;)-&gt;update($data);</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::name(&#39;user&#39;)-&gt;inc(&#39;price&#39;)-&gt;update($data); #自增加1</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::name(&#39;user&#39;)-&gt;exp(&#39;email&#39;,&#39;UPPER(email)&#39;)-&gt;update($data);让data中指定的数据的email字段变成大写</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$data &#x3D; [ &#39;username&#39; &#x3D;&gt; &#39;李白&#39;, &#39;email&#39; &#x3D;&gt; Db::raw(&#39;UPPER(email)&#39;), &#39;price&#39; &#x3D;&gt; Db::raw(&#39;price - 3&#39;), &#39;id&#39; &#x3D;&gt; 38 ];</span><br><span class="line">Db::name(&#39;user&#39;)-&gt;update($data);</span><br><span class="line">raw方法更新</span><br></pre></td></tr></table></figure>

<p>如果只想改其中的一个值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Db::name(&#39;user&#39;)-&gt;where(&#39;id&#39;, 38)-&gt;setField(&#39;username&#39;, &#39;辉夜&#39;);</span><br><span class="line">Db::name(&#39;user&#39;)-&gt;where(&#39;id&#39;, 38)-&gt;setInc(&#39;price&#39;); setDec()减值，后面可加步长</span><br></pre></td></tr></table></figure>

<h3 id="三-删除数据"><a href="#三-删除数据" class="headerlink" title="三.删除数据"></a>三.删除数据</h3><ol>
<li>极简删除可以根据主键直接删除，删除成功返回影响行数，否则 0； Db::name(‘user’)-&gt;delete(51);</li>
<li>根据主键，还可以删除多条记录； Db::name(‘user’)-&gt;delete([48,49,50]);</li>
<li>正常情况下，通过 where()方法来删除； Db::name(‘user’)-&gt;where(‘id’, 47)-&gt;delete();</li>
<li>通过 true 参数删除数据表所有数据，我还没测试，大家自行测试下； Db::name(‘user’)-&gt;delete(true);</li>
</ol>
<h2 id="查询表达式"><a href="#查询表达式" class="headerlink" title="查询表达式"></a>查询表达式</h2><h3 id="一、比较查询"><a href="#一、比较查询" class="headerlink" title="一、比较查询"></a>一、比较查询</h3><p> where(字段名,查询条件)，where(字段名,表达式,查询条件)； </p>
<p> 其中，表达式不区分大小写，包括了比较、区间和时间三种类型的查询</p>
<p>使用&lt;&gt;、&gt;、&lt;、&gt;=、&lt;=可以筛选出各种符合比较值的数据列表； </p>
<h3 id="二、区间查询"><a href="#二、区间查询" class="headerlink" title="二、区间查询"></a>二、区间查询</h3><p>1.使用like表达式去查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Db::name(&#39;user&#39;)-&gt;where(&#39;email&#39;,&#39;like&#39;,&#39;xiao%&#39;)-&gt;select();</span><br><span class="line">数组传递，模糊查询</span><br><span class="line">Db::name(&#39;user&#39;)-&gt;where(&#39;email&#39;,&#39;like&#39;,[&#39;xiao%&#39;,&#39;wu%&#39;],&#39;or&#39;)-&gt;select();注意or</span><br></pre></td></tr></table></figure>

<p>2.模版查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Db::name(&#39;user&#39;)-&gt;whereLike(&#39;email&#39;,&#39;xiao%&#39;)-&gt;select();</span><br><span class="line">Db::name(&#39;user&#39;)-&gt;whereNotLike(&#39;email&#39;,&#39;xiao%&#39;)-&gt;select();</span><br></pre></td></tr></table></figure>

<p>3.between表达式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Db::name(&#39;user&#39;)-&gt;where(&#39;id&#39;,&#39;between&#39;,&#39;19,25&#39;)-&gt;select(); </span><br><span class="line">Db::name(&#39;user&#39;)-&gt;where(&#39;id&#39;,&#39;between&#39;,[19, 25])-&gt;select();</span><br><span class="line">Db::name(&#39;user&#39;)-&gt;whereBetween(&#39;id&#39;,[19, 25])-&gt;select(); </span><br><span class="line">Db::name(&#39;user&#39;)-&gt;whereNotBetween(&#39;id&#39;,[19, 25])-&gt;select();</span><br></pre></td></tr></table></figure>

<p>4.in</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Db::name(&#39;user&#39;)-&gt;where(&#39;id&#39;,&#39;in&#39;, &#39;19,21,29&#39;)-&gt;select(); </span><br><span class="line">Db::name(&#39;user&#39;)-&gt;whereIn(&#39;id&#39;,&#39;19,21,29&#39;)-&gt;select(); </span><br><span class="line">Db::name(&#39;user&#39;)-&gt;whereNotIn(&#39;id&#39;,&#39;19,21,29&#39;)-&gt;select();</span><br></pre></td></tr></table></figure>

<p>5.null</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Db::name(&#39;user&#39;)-&gt;where(&#39;uid&#39;,&#39;null&#39;)-&gt;select(); </span><br><span class="line">Db::name(&#39;user&#39;)-&gt;where(&#39;uid&#39;,&#39;not null&#39;)-&gt;select();</span><br><span class="line">Db::name(&#39;user&#39;)-&gt;whereNull(&#39;uid&#39;)-&gt;select(); </span><br><span class="line">Db::name(&#39;user&#39;)-&gt;whereNotNull(&#39;uid&#39;)-&gt;select();</span><br></pre></td></tr></table></figure>



<h3 id="三、自定义"><a href="#三、自定义" class="headerlink" title="三、自定义"></a>三、自定义</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Db::name(&#39;user&#39;)-&gt;where(&#39;id&#39;,&#39;exp&#39;,&#39;IN (19,21,25)&#39;)-&gt;select();</span><br><span class="line">Db::name(&#39;user&#39;)-&gt;whereExp(&#39;id&#39;,&#39;IN (19,21,25)&#39;)-&gt;select();</span><br></pre></td></tr></table></figure>



<h2 id="时间查询"><a href="#时间查询" class="headerlink" title="时间查询"></a>时间查询</h2><h3 id="一、传统方式"><a href="#一、传统方式" class="headerlink" title="一、传统方式"></a>一、传统方式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">有time才会自动填充时间</span><br><span class="line">$result &#x3D; Db::name(&#39;user&#39;)-&gt;where(&#39;create_time&#39;,&#39;&gt; time&#39;,&#39;2018-1-1&#39;)-&gt;select();</span><br><span class="line">between查询</span><br><span class="line">Db::name(&#39;user&#39;)-&gt;where(&#39;create_time&#39;,&#39;between time&#39;,[&#39;2018-1-1&#39;,&#39;2019-12-1&#39;])-&gt;select();</span><br></pre></td></tr></table></figure>

<h3 id="二、快捷方式"><a href="#二、快捷方式" class="headerlink" title="二、快捷方式"></a>二、快捷方式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wheretime()</span><br><span class="line">$result &#x3D; Db::name(&#39;user&#39;)-&gt;whereTime(&#39;create_time&#39;,&#39;between&#39;,[&#39;2018-1-1&#39;,&#39;2019-12-1&#39;])-&gt;select();</span><br><span class="line">默认是大于符号</span><br><span class="line">whereBetweenTime()</span><br><span class="line">Db::name(&#39;user&#39;)-&gt;whereBetweenTime(&#39;create_time&#39;,&#39;2018-1-1&#39;,&#39;2019-12-1&#39;)-&gt;select()如果只有一个参数就是当时的一天</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="三、固定查询"><a href="#三、固定查询" class="headerlink" title="三、固定查询"></a>三、固定查询</h3><table>
<thead>
<tr>
<th align="center">last week</th>
<th>上周</th>
</tr>
</thead>
<tbody><tr>
<td align="center">month 或者 m</td>
<td>本月</td>
</tr>
<tr>
<td align="center">last month</td>
<td>上月</td>
</tr>
<tr>
<td align="center">year 或 y</td>
<td>今年</td>
</tr>
<tr>
<td align="center">last year</td>
<td>去年</td>
</tr>
<tr>
<td align="center">today</td>
<td>今天</td>
</tr>
</tbody></table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$result &#x3D; Db::name(&#39;user&#39;)-&gt;whereTime(&#39;create_time&#39;,&#39;y&#39;)-&gt;select();</span><br></pre></td></tr></table></figure>

<h3 id="四、其他查询"><a href="#四、其他查询" class="headerlink" title="四、其他查询"></a>四、其他查询</h3><p>1.查询指定时间的数据，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$result &#x3D; Db::name(&#39;user&#39;)-&gt;whereTime(&#39;create_time&#39;,&#39;-2 hour&#39;)-&gt;select();</span><br></pre></td></tr></table></figure>

<p>2.查询两个字段的数据有效期</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$result &#x3D; Db::name(&#39;user&#39;)-&gt;whereBetweenTimeField(&#39;create_time&#39;,&#39;create_time&#39;)-&gt;select();</span><br></pre></td></tr></table></figure>

<p><code>return Db::getLastSql();</code></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>Copyright： </strong>
          Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://example.com/2020/09/17/URL%E8%A7%A3%E6%9E%90%E6%A8%A1%E5%BC%8F/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ThinkPHP/" rel="tag">ThinkPHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag">编程</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2020/09/18/ThinkPHP-2/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            ThinkPHP-2
          
        </div>
      </a>
    
    
      <a href="/2020/09/14/SSTI%E7%90%86%E8%A7%A3/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">SSTI理解</div>
      </a>
    
  </nav>

   
<!-- valine评论 -->
<div id="vcomments-box">
  <div id="vcomments"></div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script>
<script>
  new Valine({
    el: "#vcomments",
    app_id: "",
    app_key: "",
    path: window.location.pathname,
    avatar: "monsterid",
    placeholder: "给我的文章加点评论吧~",
    recordIP: true,
  });
  const infoEle = document.querySelector("#vcomments .info");
  if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
    infoEle.childNodes.forEach(function (item) {
      item.parentNode.removeChild(item);
    });
  }
</script>
<style>
  #vcomments-box {
    padding: 5px 30px;
  }

  @media screen and (max-width: 800px) {
    #vcomments-box {
      padding: 5px 0px;
    }
  }

  #vcomments-box #vcomments {
    background-color: #fff;
  }

  .v .vlist .vcard .vh {
    padding-right: 20px;
  }

  .v .vlist .vcard {
    padding-left: 10px;
  }
</style>

 
     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2020
        <i class="ri-heart-fill heart_icon"></i> 码农
      </li>
    </ul>
    <ul>
      <li>
        
        
        
        Powered by Hexo
        <span class="division">|</span>
        Theme - <a href="https://github.com/anti-genemits" target="_blank">Anti-Genemits</a>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></s>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="Anti-Genemits"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E7%BC%96%E7%A8%8B/">编程</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/CTF/">CTF</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->


<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<!-- ClickLove -->

<!-- ClickBoom1 -->

<script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script>

<script src="/js/clickBoom1.js"></script>


<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


    
  </div>
</body>

</html>